

<!DOCTYPE html>
<html>
<head>
<title>Page Title</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<link rel="stylesheet" href="https://www.w3schools.com/w3css/4/w3.css">
<link rel="manifest" href="manifest.json">
<style>
input::-webkit-outer-spin-button,
input::-webkit-inner-spin-button {
  -webkit-appearance: none;
  margin: 0;
  
}
.chkbox{width:20px;}
input {font-weight:bold; width:350px; background:lightyellow; border:1px solid black; height:30px; outline:0;  transition: 0.2s 

ease-in;}
textarea {appearance:none; outline:0;  }
label{color:blue; }
button{background:red; width:150px; height:30px; border:1px solid black; ;}
body{background:powderblue; }
</style>
<script>
url='https://script.google.com/macros/s/AKfycbwU43y7aw-hY8rjx77YgViB5Vs2H5yv7i5GMuUUfB6YMLbEQn3D/exec'

async function getMyData (){
response= await fetch(url)
data= await response.json()
tempData=data["user"]
}

getMyData ()
</script>

</head>
<body>
<h4> Data Correction</h4>
<label for="fname">Input SR No</label><br>
<input type="number"  id='srnoInput'  Placeholder="Enter SR No" ><br><br>
<button onclick = "getRecord()" id='btn1' value="submit" id="submitButton">Get Data </button><br>
<hr>


<table border=1 id='dataTable' style="border-collapse:collapse; ">




</table>

<button onclick="sendEmail()" value="submit" id="submitButton">Submit</button><br>
<script>

body1=""



function getRecord(){
getsrno =  document.getElementById("srnoInput").value
myRecord = tempData.filter(a => a.srno===parseInt(getsrno))
dd= String(new Date(myRecord[0].retdate).getDate()).padStart(2,"0")
mm= String(new Date(myRecord[0].retdate).getMonth() + 1).padStart(2,"0");
yyyy= new Date(myRecord[0].retdate).getFullYear();

ddmmyyyy = dd+"/"+mm+"/"+yyyy
yyyymmdd = yyyy+"-"+mm+"-"+dd

dataForTable =
`
<tr><td><input type="checkbox" class="chkbox" id="1" ><td>SRNO: ${getsrno}</td></tr>
<tr><td><input type="checkbox" class="chkbox" id="1" ><td>Name:${myRecord[0].name}</td></tr>
<tr><td><input type="checkbox" class="chkbox" id="1" ><td>Add1: ${myRecord[0].add1}</td></tr>
<tr><td><input type="checkbox" class="chkbox" id="1" ><td>Add2: ${myRecord[0].add2}</td></tr>
<tr><td><input type="checkbox" class="chkbox" id="1" ><td>Add3: ${myRecord[0].add3}</td></tr>
<tr><td><input type="checkbox" class="chkbox" id="1" ><td>Add4: ${myRecord[0].add4}</td></tr>
<tr><td><input type="checkbox" class="chkbox" id="1" ><td>PIN: ${myRecord[0].pin}</td></tr>
<tr><td><input type="checkbox" class="chkbox" id="1" ><td>Email: ${myRecord[0].email}</td></tr>
<tr><td><input type="checkbox" class="chkbox" id="1" ><td>Mobile 1: ${myRecord[0].mob1}</td></tr>
<tr><td><input type="checkbox" class="chkbox" id="1" ><td>Mobile 2: ${myRecord[0].mob2}</td></tr>
<tr><td><input type="checkbox" class="chkbox" id="1" ><td>Fixed Line:: ${myRecord[0].fix}</td></tr>
<tr><td><input type="checkbox" class="chkbox" id="1" ><td>Retirement Date (DD/MM/YYYY): ${ddmmyyyy}</td></tr>
<tr><td><input type="checkbox" class="chkbox" id="1" ><td>Previously Worked Branches: ${myRecord[0].brlist}</td></tr>
<tr><td><input type="checkbox" class="chkbox" id="1" ><td>Last worked branch: ${myRecord[0].lastbr}</td></tr>
<tr><td><input type="checkbox" class="chkbox" id="1" ><td>Pension Branch: ${myRecord[0].penbr}</td></tr>
<tr><td><input type="checkbox" class="chkbox" id="1" ><td>Birthday (DD/MM): ${myRecord[0].bd}/${myRecord[0].bm}</td></tr>
<tr><td><input type="checkbox" class="chkbox" id="1" ><td>Marriage Anniversary (DD/MM): ${myRecord[0].md}/${myRecord[0].mm}</td></tr>

`
document.getElementById('dataTable').innerHTML=dataForTable
dataForTable=dataForTable.replaceAll("\n","")


body1 =
`SRNO: ${getsrno}%0D%0A
Name:${myRecord[0].name}%0D%0A
Add1: ${myRecord[0].add1}%0D%0A
Add2: ${myRecord[0].add2}%0D%0A
Add3: ${myRecord[0].add3}%0D%0A
Add4: ${myRecord[0].add4}%0D%0A
PIN: ${myRecord[0].pin}%0D%0A
Email: ${myRecord[0].email}%0D%0A
Mobile 1: ${myRecord[0].mob1}%0D%0A
Mobile 2: ${myRecord[0].mob2}%0D%0A
Fixed Line:: ${myRecord[0].fix}%0D%0A
Retirement Date (DD/MM/YYYY): ${ddmmyyyy}%0D%0A
Previously Worked Branches: ${myRecord[0].brlist}%0D%0A
Last worked branch: ${myRecord[0].lastbr}%0D%0A
Pension Branch: ${myRecord[0].penbr}%0D%0A
Birthday (DD/MM): ${myRecord[0].bd}/${myRecord[0].bm}%0D%0A
Marriage Anniversary (DD/MM): ${myRecord[0].md}/${myRecord[0].mm}%0D%0A
`
body1=body1.replaceAll("\n","")
}

function sendEmail(){
window.open('mailto:gvssmark@gmail.com?subject=Data Update&body='+body1)

}
//<input type="button" onclick="window.open('mailto:your@email.address?subject=Comments about the color blue');" value="Contact us" />


</script>


</body>
</html>
