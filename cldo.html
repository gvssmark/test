<!DOCTYPE html>
<html>
<head>
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.7.1/jquery.min.js"></script>
<meta name="viewport" content="width=device-width,  initial-scale=1.0">
<style>
input {padding:2px; width:80%; border:1px solid black; background:black; color:white; outline:none; margin:5px ; ;}
table, th, tr {width:100%;  border:1px solid black; border-collapse: collapse; border: 1px solid; font-size:small;}
td { text-align:center;font-size:small; border-collapse: collapse; border:1px solid black; }
.Y {background:green; color:green}
.X {background:red; color:red}
.u {background:pink; color:pink}
.M {background:yellow; color:yellow}
select {width:100%; border:none; height:30px; }
#bottomdiv {bottom:0; position:fixed; background:green; color:white; width:100%; margin: auto;}
#allsuspectstable {display:none}
</style></head>
<body >
<div id='playerlistcreate' style='margin:auto; border:1px solid black;  display: flex;  align-items: center;'>
<form  action="javascript:captureplist();">
<h4>Player Names - Starting with you in clockwise<h4>
<input type='text' name='pl1' pattern="[a-zA-Z]+"  placeholder='Player 1' required><br><br>
<input type='text' name='pl2' pattern="[a-zA-Z]+" placeholder='Player 1' required><br><br>
<input type='text' name='pl3' pattern="[a-zA-Z]+" placeholder='Player 1' required><br><br>
<input type='text' name='pl4' pattern="[a-zA-Z]+" placeholder='Player 1' ><br><br>
<input type='text' name='pl5' pattern="[a-zA-Z]+" placeholder='Player 1' ><br><br>
<input type='text' name='pl6' pattern="[a-zA-Z]+" placeholder='Player 1' ><br><br>
<button>Submit</button>
</form>
</div>
<div id='allsuspectstable'></div><br>
<div id='suspectsheldby' style='display:none'>
<table border=1><tr style='background:black; color:white; height:30px; '><td>Suspect<td>Held By<tr><td>
<select id="suspectselect" name="suspectlist" >
<option value="0">Select</option>
	  	  <option value="Col. Mustard">Col. Mustard</option>
		  <option value="Rev. Green">Rev. Green</option>
		  <option value="Prof. Plum">Prof. Plum</option>
		  <option value="Miss. Scarlet">Miss. Scarlet</option>
 		 <option value="Mrs. White">Mrs. White</option>
 		 <option value="Mrs. Peacock">Mrs. Peacock</option>
 		 <option value="Dining Room">Dining Room</option>
 		 <option value="Kitchen">Kitchen</option>
  		<option value="Hall">Hall</option>
  		<option value="Lounge">Lounge</option>
		  <option value="Ballroom">Ballroom</option>
          <option value="Billiard Room">Billiard Room</option>
 		 <option value="Study">Study</option>
		  <option value="Library">Library</option>
		  <option value="Conservatory">Conservatory</option>
		  <option value="Dagger">Dagger</option>
  		<option value="Spanner">Spanner</option>
		  <option value="Candle stick">Candle stick</option>
		  <option value="Revolver">Revolver</option>
		  <option value="Rope">Rope</option>
		  <option value="Lead Piping">Lead Piping</option>
          </select>
<td id='plistdropdown'>Held By
<tr style=' color:white; height:30px; '><td  onclick='updarray()' style='background:red'>Update<td style='background:green' onclick='hidesuspectsheldby()'>Done</table>
<li>Update cards held by you
<li>Update cards as you suspect
<h4 id='optnotselected' style='color:red; font-size:large'></h4>
</div>
<div id='allplayers' style='display:none'>allplayers</div>
<div id='suspectsselection' style='display:none'><h4>Suspects Guess by a Player. Selct from the dropdown<h4>
<table border=1><tr style='background:black; color:white; height:30px; '>
<td >Player<td>Person<td>Room<td>Wepon
<tr style='height:50px;'><td id='plistincall'><td>
		  <select id="suspectperson" name="suspectlist" >
	  	  <option value="0">Select</option>
	  	  <option value="Col. Mustard">Col. Mustard</option>
		  <option value="Rev. Green">Rev. Green</option>
		  <option value="Prof. Plum">Prof. Plum</option>
		  <option value="Miss. Scarlet">Miss. Scarlet</option>
 		 <option value="Mrs. White">Mrs. White</option>
 		 <option value="Mrs. Peacock">Mrs. Peacock</option>
		</select>
<td>
<select id="suspectroom" name="suspectroomlist" >
<option value="0">Select</option>
 		 <option value="Dining Room">Dining Room</option>
 		 <option value="Kitchen">Kitchen</option>
  		<option value="Hall">Hall</option>
  		<option value="Lounge">Lounge</option>
		  <option value="Ballroom">Ballroom</option>
 		 <option value="Study">Study</option>
 		 <option value="Billiard Room">Billiard Room</option>
		  <option value="Library">Library</option>
		  <option value="Conservatory">Conservatory</option>
		</select>
<td>
<select id="suspectweapon" name="suspectweaponlist" >
<option value="0">Select</option>
		  <option value="Dagger">Dagger</option>
  		<option value="Spanner">Spanner</option>
		  <option value="Candle stick">Candle stick</option>
		  <option value="Revolver">Revolver</option>
		  <option value="Rope">Rope</option>
		  <option value="Lead Piping">Lead Piping</option>
		</select>
<tr style='height:30px; background:yellow'><td colspan=4 onclick='playersuspected()'>Proceed
</table>
 </div>       
<h4 id='playercalledlist'></h4>
<div id='suspectstable'></div> 
<div id='playerresponses'></div>
<div id='bottomdiv' style='display:none'><table><tr><td id='btom1' >Show Table<td id='btom2'>Update<td id='btom3'>Suspect Response<td id='btom4' >Show Log</table></div>
</div>
<div id='responseslog' style='display:none'><h4>Response by Players</h4>
<div id='resplog'></div>
</div>
<script>
function hidesuspectsheldby(){document.getElementById('suspectsheldby').style.display='none'; document.getElementById('suspectsselection').style.display='block'}
var playersarray=[]
var plist=''
allsus = [   [ 'suspect'],    ['Col. Mustard'],   ['Rev. Green'],   ['Prof. Plum'],   ['Miss. Scarlet'],   ['Mrs. White'],   ['Mrs. Peacock'],   ['Dagger'],   ['Spanner'],   ['Candle stick'],   ['Revolver'],   ['Rope'],   ['Lead Piping'],   ['Dining Room'],   ['Kitchen'],   ['Hall'],   ['Lounge'],   ['Ballroom'],    ['Billiard Room'],   ['Study'],   ['Library'],   ['Conservatory']]
function captureplist(){
plist=''
allinputs = document.getElementsByTagName('input')
for (i=0; i<allinputs.length-1; i++){if(allinputs[i].value.length>0){plist += `${allinputs[i].value},`}}
plist = plist.slice(0, -1).toUpperCase().split(",") 
console.log(plist)
playersarray =plist
for(i=0; i<plist.length; i++){allsus[0].push(plist[i].substring(0,3))}
for(i=1; i<allsus.length; i++){for(j=0;j<plist.length;j++){allsus[i].push('u')}}
makeTableHTML(allsus, 'allsuspectstable')
crplist()
document.getElementById('suspectsheldby').style.display='block'
document.getElementById('playerlistcreate').style.display='none'
document.getElementById('bottomdiv').style.display='block'
}
function inital(){
plist= plist.toUpperCase().split(",")
playersarray =plist
for(i=0; i<plist.length; i++){allsus[0].push(plist[i].substring(0,3))}
for(i=1; i<allsus.length; i++){for(j=0;j<plist.length;j++){allsus[i].push('u')}}
makeTableHTML(allsus, 'allsuspectstable')
crplist()
}
function updateX(){
for(i=0; i< allsus.length; i++){
foundY= allsus[i].findIndex(a=> a==='Y')
allsusilength = allsus[i].length
if(foundY >0 ){
for(j=1; j<allsusilength; j++){
allsus[i][j]='X'}
allsus[i][foundY]='Y'}}}
function updarray(){
s=document.getElementById('suspectselect').value
p=document.getElementById('player').value
if(s*1 === 0 || p*1===0) {document.getElementById('optnotselected').innerHTML='Options Not Selected!'; return false}
document.getElementById('optnotselected').innerHTML=''
suspIndex = allsus.findIndex(a=> a[0]===s)
playIndex = allsus[0].findIndex(a=> a===p)
cstatus = allsus[suspIndex][playIndex]
if(cstatus !='X'){allsus[suspIndex][playIndex]="Y"}
updateX()
makeTableHTML(allsus, 'allsuspectstable')
console.table(allsus)
}
function makeTableHTML(arr, element) {
 newtable= `<table border=1>${arr.reduce((c, o) => c += `<tr>${o.reduce((c, d) => (c += `<td class='${d}'>${d}</td>`), '')}</tr>`, '')}</table> <br>`
 document.getElementById(element).innerHTML=newtable 
}
function playersuspected(room,person,wepon){
room   = document.getElementById('suspectroom').value
person = document.getElementById('suspectperson').value
wepon  = document.getElementById('suspectweapon').value
caller = document.getElementById('plistincall').childNodes[0].value
if(room*1===0 || person*1 ===0 || wepon*1 ===0 || caller*1 ===0 ){ suspectedh4='Options Not Selected!'; 
document.getElementById('playercalledlist').innerHTML= suspectedh4
return false}
suspectedh4 = `Call by ${caller} : <br> ${person} - ${wepon} - ${room}  `
document.getElementById('playercalledlist').innerHTML= suspectedh4
oncallarray = allsus.filter(a=> a[0] === room || a[0] === person || a[0] === wepon || a[0] === 'suspect' )
makeTableHTML(oncallarray, 'suspectstable')
resptab()
document.getElementById('suspectsselection').style.display='none'
document.getElementById('suspectstable').style.display = 'block'
document.getElementById('playerresponses').style.display = 'block'
document.getElementById('playercalledlist').style.display = 'block'
}
function crplist(){
plistoptions=''
playersarray.forEach(a=> plistoptions += `<option value=${a.substring(0,3)}>${a}</option>`)
pl=`<select id="player" name="playerlist" ><option value="0">Select</option>${plistoptions}</select>`
document.getElementById('plistdropdown').innerHTML=pl
document.getElementById('plistincall').innerHTML=pl
}
crplist()
function resptab(){
caller = document.getElementById('plistincall').childNodes[0].value
filteredcallers = allsus[0].filter(a=> a !=caller && a != 'suspect')
console.table(filteredcallers)
resptabdata=''
filteredcallers .forEach(a=> resptabdata+= `<tr style='height:40px;' ><td>${a}<td onclick='responseNo(this.id)' id='N${a}'>No<td onclick='responseYes(this.id)'id='Y${a}'>Yes`)
document.getElementById('playerresponses').innerHTML =`<table border=1>${resptabdata}</table><br>`
}
function responseNo(a){
rplayer = a.substring(1)
caller = document.getElementById('plistincall').childNodes[0].value
rroom = document.getElementById('suspectroom').value
rperson = document.getElementById('suspectperson').value
rwepon= document.getElementById('suspectweapon').value
yesnoresponsee(rplayer, rroom, 'X' )
yesnoresponsee(rplayer, rwepon, 'X' )
yesnoresponsee(rplayer, rperson, 'X' )
resparray.push([caller,rperson,rroom,rwepon,rplayer,'X' ])
makeTableHTML(resparray, 'resplog')
}
function responseYes(a){
rplayer = a.substring(1)
caller = document.getElementById('plistincall').childNodes[0].value
rroom = document.getElementById('suspectroom').value
rperson = document.getElementById('suspectperson').value
rwepon= document.getElementById('suspectweapon').value
yesnoresponsee(rplayer, rroom, 'M' )
yesnoresponsee(rplayer, rwepon, 'M' )
yesnoresponsee(rplayer, rperson, 'M' )
resparray.push([caller,rperson,rroom,rwepon,rplayer,'M'])
makeTableHTML(resparray, 'resplog')
document.getElementById('suspectsselection').style.display='block'
document.getElementById('suspectstable').style.display = 'none'
document.getElementById('playerresponses').style.display = 'none'
document.getElementById('playercalledlist').innerHTML=''
}
function yesnoresponsee(p, s, r ){
suspIndex = allsus.findIndex(a=> a[0]===s)
playIndex = allsus[0].findIndex(a=> a===p)
cstatus = allsus[suspIndex][playIndex]
//if(cstatus ==='Y'){document.getElementById('cardheldstatus').innerHTML= "Check Response!" ; return false}
if(cstatus ==='u' || cstatus ==='M'){allsus[suspIndex][playIndex]=r}
makeTableHTML(allsus, 'allsuspectstable')
makeTableHTML(oncallarray, 'suspectstable')
}
resparray=[['Call','Person','Room','Wepon','RespBy','Response']]
$(document).ready(function(){
  $("#btom1").click(function(){$("#allsuspectstable").toggle(1000, function(){});});
  $("#btom4").click(function(){$("#responseslog").toggle(1000, function(){});});
  $("#btom3").click(function(){$("#suspectsselection").toggle(1000, function(){});});
  $("#btom2").click(function(){$("#suspectsheldby").toggle(1000, function(){});});
});
</script>
</body>
</html>
